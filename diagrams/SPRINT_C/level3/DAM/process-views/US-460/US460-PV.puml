@startuml Process View - Level 3

autonumber
skinparam packageStyle rect

title Create Task

participant "Node Backend" as BE <<component>>
database "Mongo DataBase" as DB <<component>>

-> BE: POST tasks/{domainId?: domainId, robisepType: robisepTypeId,\n pickUpAndDeliveryTask?: pickUpAndDeliveryTask, surveillanceTask?: surveillanceTask}

note right of BE: Create a new task. Task can either be a pickup and delivery task or a surveillance task.\nEither way, both tasks creation make the same calls to Mongo Database.

'Find by Robisep Type ID'

activate BE

BE -> DB: find by robisep type id

activate DB

DB --> BE:

deactivate DB

alt robisep type not found

  <-- BE: Response status code - 404

else database unavailable

  <-- BE: Response status code - 503

end

'Find by Room ID'

activate BE

BE -> DB: find by room id

activate DB

DB --> BE:

deactivate DB

alt room not found

  <-- BE: Response status code - 404

else database unavailable

  <-- BE: Response status code - 503

end

'Find By Room ID'

activate BE

BE -> DB: find by room id

activate DB

DB --> BE:

deactivate DB

alt room not found

  <-- BE: Response status code - 404

else database unavailable

  <-- BE: Response status code - 503

end


activate BE

BE -> DB: save

activate DB

DB --> BE:

deactivate DB

alt task persisted

  <-- BE: Response status code - 201

else database unavailable

  <-- BE: Response status code - 503

end

@enduml